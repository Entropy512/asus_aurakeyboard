#!/usr/bin/env python3

import hid
import binascii

h = hid.enumerate()

#print(h)

my_idx = None
for j in range(len(h)):
#    print(h[j])
    if((h[j]['interface_number'] == 2) & (h[j]['product_string'] == 'N-KEY Device')):
        my_idx = j

#print(h[my_idx]['path'])

d = hid.Device(path=h[my_idx]['path'])

commandstr_rainbow = binascii.unhexlify('5db30003000000f50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000')
commandstr_breathe = binascii.unhexlify('5db30001ff0000f5000100ff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000')
commandstr2 = binascii.unhexlify('5db50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000')
commandstr3 = binascii.unhexlify('5db40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000')
commandstr4 = binascii.unhexlify('5db50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000')

d.write(commandstr_rainbow)
d.write(commandstr2)
d.write(commandstr3)
d.write(commandstr4)
